This README file describes VeriSol tool and it's execution.

1. ## Prerequisites

1.1 
### SOLC
The Solidity compiler used for this project.
```
sanghu@sanghu-VirtualBox:~/Desktop$ solc --version
solc, the solidity compiler commandline interface
Version: 0.8.16+commit.07a7930e.Linux.g++
###Note: VeriSol has been tested on above version. So, please make sure that the version of solc you use should have Model Checker Options.
```
```
sudo add-apt-repository ppa:ethereum/ethereum
sudo add-apt-repository ppa:ethereum/ethereum-dev
sudo apt-get update
sudo apt-get install solc
```

1.2 
### GCC
The C++ compiler used for this project.
```bash
sudo apt-get install build-essential
```

1.3 
### Python
The Python interpreter used for this project.
```bash
sudo apt install python
```

2
## Getting things ready

For the demonstration purposes of this project, we use the [Ballot](Ballot.sol) smart contract. Also, for full set of 70 smart contrac

## Assertion Insertion
The first task is inserting assertion pairs for every conditional statement. They act as a breakpoint when the control flow reaches at that point for the dynamic testcases generated by Solidity model checking.

```
solidity/.assertinserter is an executable to inject the assert properties.
```

## Bounded Model Checker
Now that the assertion pairs are inserted, we can use solidity with bounded model checker to generate a list of assertion violations. A convenient executable [solidity/VeriSol] does the samething and produces a folder with all the necessary files with a file naming all the listed assertion violations. 

```
solidity/VeriSol
```
3. Run with single Program Ballot.sol
3.1 To run with bmc option and 60 sec, execute below command.
```
./VeriSol Ballot bmc 60
``` 
Output:
sanghu@sanghu-VirtualBox:~/Desktop/solidity$ ./VeriSol Ballot bmc 60
Properties inserted : 26
Properties violation detected (dynamic) : 23
Properties violation detected (unique) : 23
Total atomic condition : 13
Condition Coverage % : 88
****************Time Analysis Report - Start**************************
***Total runtime in seconds .480652712
Total runtime: 0:00:00:0.4807
****************Time Analysis Report - End**************************
sanghu@sanghu-VirtualBox:~/Desktop/solidity$ 
```
3.2 To run with chc option and 60 sec, execute below command.
```
./VeriSol Ballot chc 60
``` 
Output:
sanghu@sanghu-VirtualBox:~/Desktop/solidity$ ./VeriSol Ballot chc 60
Properties inserted : 26
Properties violation detected (dynamic) : 17
Properties violation detected (unique) : 17
Total atomic condition : 13
Condition Coverage % : 65
****************Time Analysis Report - Start**************************
***Total runtime in seconds 17.098821732
Total runtime: 0:00:00:17.0988
****************Time Analysis Report - End**************************
sanghu@sanghu-VirtualBox:~/Desktop/solidity$ 

```
3.3 File Structure for the bmc result folder
```
solidity/Results/Ballot-bmc/Assertions_Insertesd.txt
solidity/Results/Ballot-bmc/Ballot.sol
solidity/Results/Ballot-bmc/Ballot_Final_Output.txt
solidity/Results/Ballot-bmc/Ballot_mod.sol
solidity/Results/Ballot-bmc/Ballot_output.txt
solidity/Results/Ballot-bmc/Ballot_result.txt
solidity/Results/Ballot-bmc/Time-Ballot.txt
solidity/Results/Ballot-bmc/Total_Assertions.txt
solidity/Results/Ballot-bmc/Unique_Assertions.txt
```
3.4 File Structure for the chc result folder
```
solidity/Results/Ballot-chc/Assertions_Insertesd.txt
solidity/Results/Ballot-chc/Ballot.sol
solidity/Results/Ballot-chc/Ballot_Final_Output.txt
solidity/Results/Ballot-chc/Ballot_mod.sol
solidity/Results/Ballot-chc/Ballot_output.txt
solidity/Results/Ballot-chc/Ballot_result.txt
solidity/Results/Ballot-chc/Time-Ballot.txt
solidity/Results/Ballot-chc/Total_Assertions.txt
solidity/Results/Ballot-chc/Unique_Assertions.txt
```

Note: Please rename or delete "Results" folder before running further.

4. Run first 5 smart contracts "AnyswapV5ERC20, AssetTransfer, Ballot,
BasicProvenance, ClockBoxContract" for 300 sec using below command: 
```
./run-VeriSol-Few.sh
```
Note: This execution will take XXX minutes. Please rename or delete "Results" folder before running further

5. Run 70 smart contracts for 300 sec using below command: 
```
./run-VeriSol-Full.sh
```
Note: This execution will take Approx. 12 Hours. Please rename or delete "Results" folder before running further

6. For points 4 and 5 above .csv file will be generated automatically to analyse the results. 
```
#LOCs	 : Total Lines of Code for Original Smart Contract
#MODLOCs : Total Lines of Code for Modified Smart Contract
#PB	 : Total Properties injected for BMC
#PDDB	 : Total Properties Detected (Dynamically) for BMC
#PDUB	 : Total Properties Detected (Uniquely) for BMC
#TDB 	 : Total Detected Condition for BMC
#CCB	 : Condition Coverage for BMC
TimeB	 : Execution Time for BMC
#PC	 : Total Properties injected for CHC
#PDDC	 : Total Properties Detected (Dynamically) for CHC
#PDUC	 : Total Properties Detected (Uniquely) for CHC
#TDC 	 : Total Detected Condition for CHC
#CCC	 : Condition Coverage for CHC
TimeC	 : Execution Time for CHC
```

7. For above points 3, 4 and 5  results are provided in below folders:
``` 
solidity/Results-Ballot-Paper
solidity/Results-Few
solidity/Results-Full
```

8. File structure for the entire folder "Solidity" is given below:

## File Structure
solidity/Address.sol
solidity/AIRBets.sol
solidity/Animalia.sol
.
.
.
.
....~~~All 70 .sol files
solidity/README.md
solidity/VeriSol
solidity/VeriSol.sh.x.c
solidity/.assertinserter
solidity/.cmntrmv
solidity/run-extract.sh
solidity/run-VeriSol-Few.sh
solidity/run-VeriSol-Full.sh
solidity/Results-Ballot-Paper
solidity/Results-Few
solidity/Results-Full

